async function run() {
    const data = new FMnistData();
    await data.load();
    const model = getModel();
    tfvis.show.modelSummary({ name: 'Model Architecture' }, model);
    await train(model, data);
    await model.save('downloads://my_model');
    init();
    alert("Training is done, try classifying your drawings!");
}

document.addEventListener('DOMContentLoaded', run);

document.getElementById('classifyBtn').addEventListener('click', function() {
    var raw = tf.browser.fromPixels(rawImage, 1);
    var resized = tf.image.resizeBilinear(raw, [28, 28]);
    var tensor = resized.expandDims(0);

    var prediction = model.predict(tensor);
    var pIndex = tf.argMax(prediction, 1).dataSync();

    var classNames = ["T-shirt/top", "Trouser", "Pullover",
        "Dress", "Coat", "Sandal", "Shirt",
        "Sneaker", "Bag", "Ankle boot"
    ];

    alert(classNames[pIndex]);
});
